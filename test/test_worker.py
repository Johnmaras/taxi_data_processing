from unittest import TestCase

from worker.src import worker


class Test(TestCase):
    def test_handler(self):
        data = '[{"id": "id3194108", "vendor_id": "1", "pickup_datetime": "2016-06-01 11:48:41", "dropoff_datetime": "2016-06-01 12:19:07", "passenger_count": "1", "pickup_longitude": "-74.005027770996094", "pickup_latitude": "40.746452331542969", "dropoff_longitude": "-73.972007751464844", "dropoff_latitude": "40.745780944824219", "store_and_fwd_flag": "N", "trip_duration": "1826"}, {"id": "id2063827", "vendor_id": "1", "pickup_datetime": "2016-05-18 21:09:02", "dropoff_datetime": "2016-05-18 21:18:55", "passenger_count": "1", "pickup_longitude": "-73.981414794921875", "pickup_latitude": "40.756732940673828", "dropoff_longitude": "-73.970565795898438", "dropoff_latitude": "40.755695343017578", "store_and_fwd_flag": "N", "trip_duration": "593"}, {"id": "id0105610", "vendor_id": "1", "pickup_datetime": "2016-02-19 20:01:24", "dropoff_datetime": "2016-02-19 20:35:49", "passenger_count": "3", "pickup_longitude": "-73.789718627929688", "pickup_latitude": "40.643707275390625", "dropoff_longitude": "-73.97869873046875", "dropoff_latitude": "40.750343322753906", "store_and_fwd_flag": "N", "trip_duration": "2065"}, {"id": "id3502065", "vendor_id": "1", "pickup_datetime": "2016-03-15 21:03:44", "dropoff_datetime": "2016-03-15 21:14:37", "passenger_count": "1", "pickup_longitude": "-73.974014282226563", "pickup_latitude": "40.757152557373047", "dropoff_longitude": "-73.949737548828125", "dropoff_latitude": "40.777091979980469", "store_and_fwd_flag": "N", "trip_duration": "653"}, {"id": "id3508035", "vendor_id": "2", "pickup_datetime": "2016-06-06 20:13:56", "dropoff_datetime": "2016-06-06 20:45:20", "passenger_count": "6", "pickup_longitude": "-73.788131713867188", "pickup_latitude": "40.641460418701172", "dropoff_longitude": "-73.971771240234375", "dropoff_latitude": "40.749408721923828", "store_and_fwd_flag": "N", "trip_duration": "1884"}, {"id": "id3236276", "vendor_id": "2", "pickup_datetime": "2016-01-27 08:07:32", "dropoff_datetime": "2016-01-27 08:24:01", "passenger_count": "1", "pickup_longitude": "-73.956039428710937", "pickup_latitude": "40.767608642578125", "dropoff_longitude": "-73.96820068359375", "dropoff_latitude": "40.786689758300781", "store_and_fwd_flag": "N", "trip_duration": "989"}, {"id": "id3277902", "vendor_id": "1", "pickup_datetime": "2016-04-09 15:04:31", "dropoff_datetime": "2016-04-09 15:11:30", "passenger_count": "1", "pickup_longitude": "-73.973167419433594", "pickup_latitude": "40.755699157714844", "dropoff_longitude": "-73.988655090332031", "dropoff_latitude": "40.736995697021484", "store_and_fwd_flag": "N", "trip_duration": "419"}, {"id": "id2335059", "vendor_id": "1", "pickup_datetime": "2016-05-27 11:10:32", "dropoff_datetime": "2016-05-27 11:26:34", "passenger_count": "4", "pickup_longitude": "-73.975807189941406", "pickup_latitude": "40.760627746582031", "dropoff_longitude": "-73.987785339355469", "dropoff_latitude": "40.754920959472656", "store_and_fwd_flag": "N", "trip_duration": "962"}, {"id": "id2300865", "vendor_id": "1", "pickup_datetime": "2016-05-10 10:31:22", "dropoff_datetime": "2016-05-10 10:35:25", "passenger_count": "1", "pickup_longitude": "-73.96588134765625", "pickup_latitude": "40.762840270996094", "dropoff_longitude": "-73.960990905761719", "dropoff_latitude": "40.7708740234375", "store_and_fwd_flag": "N", "trip_duration": "243"}, {"id": "id3962434", "vendor_id": "2", "pickup_datetime": "2016-01-10 08:45:31", "dropoff_datetime": "2016-01-10 08:51:44", "passenger_count": "2", "pickup_longitude": "-73.989273071289063", "pickup_latitude": "40.756488800048828", "dropoff_longitude": "-74.002799987792969", "dropoff_latitude": "40.760501861572266", "store_and_fwd_flag": "N", "trip_duration": "373"}, {"id": "id2677672", "vendor_id": "1", "pickup_datetime": "2016-02-18 17:47:39", "dropoff_datetime": "2016-02-18 17:54:03", "passenger_count": "2", "pickup_longitude": "-73.945755004882813", "pickup_latitude": "40.773681640625", "dropoff_longitude": "-73.95343017578125", "dropoff_latitude": "40.781078338623047", "store_and_fwd_flag": "N", "trip_duration": "384"}, {"id": "id0589360", "vendor_id": "1", "pickup_datetime": "2016-05-22 17:34:08", "dropoff_datetime": "2016-05-22 18:20:01", "passenger_count": "1", "pickup_longitude": "-73.863677978515625", "pickup_latitude": "40.769771575927734", "dropoff_longitude": "-74.007217407226563", "dropoff_latitude": "40.70489501953125", "store_and_fwd_flag": "N", "trip_duration": "2753"}, {"id": "id0970832", "vendor_id": "1", "pickup_datetime": "2016-03-12 20:39:39", "dropoff_datetime": "2016-03-12 21:05:40", "passenger_count": "1", "pickup_longitude": "-74.008247375488281", "pickup_latitude": "40.747352600097656", "dropoff_longitude": "-73.979446411132813", "dropoff_latitude": "40.71875", "store_and_fwd_flag": "N", "trip_duration": "1561"}, {"id": "id0694434", "vendor_id": "1", "pickup_datetime": "2016-01-26 23:40:14", "dropoff_datetime": "2016-01-26 23:48:39", "passenger_count": "1", "pickup_longitude": "-74.006797790527344", "pickup_latitude": "40.706073760986328", "dropoff_longitude": "-73.974021911621094", "dropoff_latitude": "40.744075775146484", "store_and_fwd_flag": "N", "trip_duration": "505"}, {"id": "id3729136", "vendor_id": "2", "pickup_datetime": "2016-01-30 15:15:47", "dropoff_datetime": "2016-01-30 15:30:47", "passenger_count": "2", "pickup_longitude": "-73.977272033691406", "pickup_latitude": "40.757350921630859", "dropoff_longitude": "-74.002433776855469", "dropoff_latitude": "40.734401702880859", "store_and_fwd_flag": "N", "trip_duration": "900"}, {"id": "id2358953", "vendor_id": "2", "pickup_datetime": "2016-06-27 00:31:28", "dropoff_datetime": "2016-06-27 01:06:44", "passenger_count": "1", "pickup_longitude": "-73.870819091796875", "pickup_latitude": "40.773738861083984", "dropoff_longitude": "-73.857498168945313", "dropoff_latitude": "41.017810821533203", "store_and_fwd_flag": "N", "trip_duration": "2116"}, {"id": "id0935429", "vendor_id": "1", "pickup_datetime": "2016-05-02 06:58:06", "dropoff_datetime": "2016-05-02 07:08:17", "passenger_count": "1", "pickup_longitude": "-73.999092102050781", "pickup_latitude": "40.745491027832031", "dropoff_longitude": "-73.978561401367188", "dropoff_latitude": "40.762325286865234", "store_and_fwd_flag": "N", "trip_duration": "611"}, {"id": "id3056417", "vendor_id": "2", "pickup_datetime": "2016-04-11 14:18:21", "dropoff_datetime": "2016-04-11 14:34:33", "passenger_count": "1", "pickup_longitude": "-73.984359741210937", "pickup_latitude": "40.742710113525391", "dropoff_longitude": "-73.987747192382813", "dropoff_latitude": "40.751888275146484", "store_and_fwd_flag": "N", "trip_duration": "972"}, {"id": "id1152886", "vendor_id": "2", "pickup_datetime": "2016-01-21 14:34:06", "dropoff_datetime": "2016-01-21 14:44:10", "passenger_count": "1", "pickup_longitude": "-73.961677551269531", "pickup_latitude": "40.77117919921875", "dropoff_longitude": "-73.952110290527344", "dropoff_latitude": "40.784358978271484", "store_and_fwd_flag": "N", "trip_duration": "604"}, {"id": "id1796723", "vendor_id": "1", "pickup_datetime": "2016-02-09 15:54:53", "dropoff_datetime": "2016-02-09 16:04:47", "passenger_count": "1", "pickup_longitude": "-73.993858337402344", "pickup_latitude": "40.735797882080078", "dropoff_longitude": "-73.994621276855469", "dropoff_latitude": "40.750461578369141", "store_and_fwd_flag": "N", "trip_duration": "594"}, {"id": "id0045014", "vendor_id": "1", "pickup_datetime": "2016-04-20 20:29:42", "dropoff_datetime": "2016-04-20 20:39:16", "passenger_count": "1", "pickup_longitude": "-73.950126647949219", "pickup_latitude": "40.780086517333984", "dropoff_longitude": "-73.96282958984375", "dropoff_latitude": "40.762683868408203", "store_and_fwd_flag": "N", "trip_duration": "574"}, {"id": "id2648478", "vendor_id": "1", "pickup_datetime": "2016-01-18 11:13:59", "dropoff_datetime": "2016-01-18 11:18:56", "passenger_count": "1", "pickup_longitude": "-73.951576232910156", "pickup_latitude": "40.766468048095703", "dropoff_longitude": "-73.960212707519531", "dropoff_latitude": "40.760540008544922", "store_and_fwd_flag": "N", "trip_duration": "297"}, {"id": "id0702030", "vendor_id": "1", "pickup_datetime": "2016-01-07 23:24:44", "dropoff_datetime": "2016-01-07 23:26:25", "passenger_count": "1", "pickup_longitude": "-73.999298095703125", "pickup_latitude": "40.749534606933594", "dropoff_longitude": "-74.005363464355469", "dropoff_latitude": "40.743518829345703", "store_and_fwd_flag": "N", "trip_duration": "101"}, {"id": "id3024438", "vendor_id": "2", "pickup_datetime": "2016-06-10 22:24:37", "dropoff_datetime": "2016-06-10 22:41:58", "passenger_count": "1", "pickup_longitude": "-73.953720092773438", "pickup_latitude": "40.775295257568359", "dropoff_longitude": "-73.991195678710938", "dropoff_latitude": "40.726318359375", "store_and_fwd_flag": "N", "trip_duration": "1041"}, {"id": "id2146569", "vendor_id": "2", "pickup_datetime": "2016-06-23 22:17:35", "dropoff_datetime": "2016-06-23 22:21:07", "passenger_count": "1", "pickup_longitude": "-73.976799011230469", "pickup_latitude": "40.749950408935547", "dropoff_longitude": "-73.9815673828125", "dropoff_latitude": "40.745769500732422", "store_and_fwd_flag": "N", "trip_duration": "212"}, {"id": "id2307151", "vendor_id": "1", "pickup_datetime": "2016-02-07 18:08:06", "dropoff_datetime": "2016-02-07 18:15:08", "passenger_count": "1", "pickup_longitude": "-73.961952209472656", "pickup_latitude": "40.800445556640625", "dropoff_longitude": "-73.978416442871094", "dropoff_latitude": "40.782791137695312", "store_and_fwd_flag": "N", "trip_duration": "422"}, {"id": "id2049424", "vendor_id": "2", "pickup_datetime": "2016-03-02 20:15:07", "dropoff_datetime": "2016-03-02 20:37:43", "passenger_count": "1", "pickup_longitude": "-73.963890075683594", "pickup_latitude": "40.773651123046875", "dropoff_longitude": "-74.005111694335938", "dropoff_latitude": "40.751491546630859", "store_and_fwd_flag": "N", "trip_duration": "1356"}, {"id": "id2209089", "vendor_id": "1", "pickup_datetime": "2016-02-24 22:56:43", "dropoff_datetime": "2016-02-24 23:03:39", "passenger_count": "1", "pickup_longitude": "-74.006912231445313", "pickup_latitude": "40.730361938476563", "dropoff_longitude": "-74.005943298339844", "dropoff_latitude": "40.727069854736328", "store_and_fwd_flag": "N", "trip_duration": "416"}, {"id": "id0391524", "vendor_id": "1", "pickup_datetime": "2016-04-06 12:14:40", "dropoff_datetime": "2016-04-06 12:33:18", "passenger_count": "1", "pickup_longitude": "-73.978645324707031", "pickup_latitude": "40.748035430908203", "dropoff_longitude": "-73.970130920410156", "dropoff_latitude": "40.762737274169922", "store_and_fwd_flag": "N", "trip_duration": "1118"}, {"id": "id2681033", "vendor_id": "1", "pickup_datetime": "2016-06-17 10:01:39", "dropoff_datetime": "2016-06-17 10:16:13", "passenger_count": "1", "pickup_longitude": "-73.976829528808594", "pickup_latitude": "40.788211822509766", "dropoff_longitude": "-73.983749389648438", "dropoff_latitude": "40.762531280517578", "store_and_fwd_flag": "N", "trip_duration": "874"}, {"id": "id2040275", "vendor_id": "1", "pickup_datetime": "2016-06-16 20:31:09", "dropoff_datetime": "2016-06-16 20:36:30", "passenger_count": "1", "pickup_longitude": "-73.936943054199219", "pickup_latitude": "40.798233032226563", "dropoff_longitude": "-73.946380615234375", "dropoff_latitude": "40.7808837890625", "store_and_fwd_flag": "N", "trip_duration": "321"}, {"id": "id0073842", "vendor_id": "2", "pickup_datetime": "2016-03-30 23:49:41", "dropoff_datetime": "2016-03-30 23:56:21", "passenger_count": "1", "pickup_longitude": "-73.99005126953125", "pickup_latitude": "40.738010406494141", "dropoff_longitude": "-73.990936279296875", "dropoff_latitude": "40.725215911865234", "store_and_fwd_flag": "N", "trip_duration": "400"}, {"id": "id3942339", "vendor_id": "1", "pickup_datetime": "2016-01-05 17:58:04", "dropoff_datetime": "2016-01-05 18:13:38", "passenger_count": "1", "pickup_longitude": "-73.978828430175781", "pickup_latitude": "40.752803802490234", "dropoff_longitude": "-73.991035461425781", "dropoff_latitude": "40.750419616699219", "store_and_fwd_flag": "N", "trip_duration": "934"}, {"id": "id2991616", "vendor_id": "2", "pickup_datetime": "2016-03-19 19:51:34", "dropoff_datetime": "2016-03-19 20:04:27", "passenger_count": "3", "pickup_longitude": "-73.983566284179688", "pickup_latitude": "40.755561828613281", "dropoff_longitude": "-73.982368469238281", "dropoff_latitude": "40.766960144042969", "store_and_fwd_flag": "N", "trip_duration": "773"}, {"id": "id1047459", "vendor_id": "2", "pickup_datetime": "2016-01-22 17:31:53", "dropoff_datetime": "2016-01-22 17:37:30", "passenger_count": "3", "pickup_longitude": "-73.988410949707031", "pickup_latitude": "40.758960723876953", "dropoff_longitude": "-73.991897583007812", "dropoff_latitude": "40.77069091796875", "store_and_fwd_flag": "N", "trip_duration": "337"}, {"id": "id1737558", "vendor_id": "1", "pickup_datetime": "2016-05-18 19:08:31", "dropoff_datetime": "2016-05-18 19:12:25", "passenger_count": "1", "pickup_longitude": "-73.960235595703125", "pickup_latitude": "40.762229919433594", "dropoff_longitude": "-73.950592041015625", "dropoff_latitude": "40.775314331054687", "store_and_fwd_flag": "N", "trip_duration": "234"}, {"id": "id2135557", "vendor_id": "2", "pickup_datetime": "2016-05-25 13:19:56", "dropoff_datetime": "2016-05-25 13:27:50", "passenger_count": "5", "pickup_longitude": "-73.970283508300781", "pickup_latitude": "40.76483154296875", "dropoff_longitude": "-73.957572937011719", "dropoff_latitude": "40.782478332519531", "store_and_fwd_flag": "N", "trip_duration": "474"}, {"id": "id0659170", "vendor_id": "2", "pickup_datetime": "2016-03-26 13:07:08", "dropoff_datetime": "2016-03-26 13:29:02", "passenger_count": "1", "pickup_longitude": "-73.968658447265625", "pickup_latitude": "40.764507293701172", "dropoff_longitude": "-73.872833251953125", "dropoff_latitude": "40.771453857421875", "store_and_fwd_flag": "N", "trip_duration": "1314"}, {"id": "id1125774", "vendor_id": "1", "pickup_datetime": "2016-01-19 22:20:43", "dropoff_datetime": "2016-01-19 22:28:45", "passenger_count": "2", "pickup_longitude": "-73.994537353515625", "pickup_latitude": "40.740234375", "dropoff_longitude": "-73.976188659667969", "dropoff_latitude": "40.762592315673828", "store_and_fwd_flag": "N", "trip_duration": "482"}, {"id": "id1886740", "vendor_id": "1", "pickup_datetime": "2016-05-29 00:15:12", "dropoff_datetime": "2016-05-29 00:24:38", "passenger_count": "1", "pickup_longitude": "-73.985115051269531", "pickup_latitude": "40.768726348876953", "dropoff_longitude": "-73.951667785644531", "dropoff_latitude": "40.774433135986328", "store_and_fwd_flag": "N", "trip_duration": "566"}, {"id": "id1982306", "vendor_id": "2", "pickup_datetime": "2016-02-10 21:06:14", "dropoff_datetime": "2016-02-10 21:09:23", "passenger_count": "2", "pickup_longitude": "-73.984939575195313", "pickup_latitude": "40.751857757568359", "dropoff_longitude": "-73.983543395996094", "dropoff_latitude": "40.744335174560547", "store_and_fwd_flag": "N", "trip_duration": "189"}, {"id": "id2684106", "vendor_id": "2", "pickup_datetime": "2016-02-26 20:59:13", "dropoff_datetime": "2016-02-26 21:14:26", "passenger_count": "2", "pickup_longitude": "-74.001007080078125", "pickup_latitude": "40.731781005859375", "dropoff_longitude": "-73.987152099609375", "dropoff_latitude": "40.771003723144531", "store_and_fwd_flag": "N", "trip_duration": "913"}, {"id": "id0038484", "vendor_id": "2", "pickup_datetime": "2016-03-09 13:41:11", "dropoff_datetime": "2016-03-09 13:53:27", "passenger_count": "2", "pickup_longitude": "-73.972854614257813", "pickup_latitude": "40.764400482177734", "dropoff_longitude": "-73.971809387207031", "dropoff_latitude": "40.757888793945313", "store_and_fwd_flag": "N", "trip_duration": "736"}, {"id": "id1734208", "vendor_id": "2", "pickup_datetime": "2016-04-11 10:44:32", "dropoff_datetime": "2016-04-11 10:56:26", "passenger_count": "6", "pickup_longitude": "-73.997077941894531", "pickup_latitude": "40.720638275146484", "dropoff_longitude": "-73.9996337890625", "dropoff_latitude": "40.745838165283203", "store_and_fwd_flag": "N", "trip_duration": "714"}, {"id": "id0561467", "vendor_id": "1", "pickup_datetime": "2016-02-09 06:58:53", "dropoff_datetime": "2016-02-09 07:12:28", "passenger_count": "1", "pickup_longitude": "-73.972549438476562", "pickup_latitude": "40.794017791748047", "dropoff_longitude": "-73.954055786132813", "dropoff_latitude": "40.766300201416016", "store_and_fwd_flag": "N", "trip_duration": "815"}, {"id": "id3092788", "vendor_id": "2", "pickup_datetime": "2016-03-03 22:01:32", "dropoff_datetime": "2016-03-03 22:17:44", "passenger_count": "2", "pickup_longitude": "-73.984771728515625", "pickup_latitude": "40.7105712890625", "dropoff_longitude": "-73.989410400390625", "dropoff_latitude": "40.730148315429687", "store_and_fwd_flag": "N", "trip_duration": "972"}, {"id": "id1741519", "vendor_id": "2", "pickup_datetime": "2016-03-26 14:47:44", "dropoff_datetime": "2016-03-26 14:53:02", "passenger_count": "1", "pickup_longitude": "-73.984786987304688", "pickup_latitude": "40.743015289306641", "dropoff_longitude": "-73.993606567382812", "dropoff_latitude": "40.735286712646484", "store_and_fwd_flag": "N", "trip_duration": "318"}, {"id": "id1330402", "vendor_id": "2", "pickup_datetime": "2016-05-22 18:06:05", "dropoff_datetime": "2016-05-22 18:16:30", "passenger_count": "1", "pickup_longitude": "-73.9918212890625", "pickup_latitude": "40.750076293945312", "dropoff_longitude": "-73.971054077148438", "dropoff_latitude": "40.756698608398438", "store_and_fwd_flag": "N", "trip_duration": "625"}, {"id": "id2505596", "vendor_id": "2", "pickup_datetime": "2016-05-28 22:53:12", "dropoff_datetime": "2016-05-28 23:07:31", "passenger_count": "1", "pickup_longitude": "-73.9849853515625", "pickup_latitude": "40.748580932617188", "dropoff_longitude": "-73.981277465820313", "dropoff_latitude": "40.769115447998047", "store_and_fwd_flag": "N", "trip_duration": "859"}, {"id": "id1630509", "vendor_id": "2", "pickup_datetime": "2016-03-16 05:42:49", "dropoff_datetime": "2016-03-16 05:45:10", "passenger_count": "2", "pickup_longitude": "-73.993667602539063", "pickup_latitude": "40.741878509521484", "dropoff_longitude": "-73.984588623046875", "dropoff_latitude": "40.754299163818359", "store_and_fwd_flag": "N", "trip_duration": "141"}, {"id": "id0512853", "vendor_id": "1", "pickup_datetime": "2016-05-28 17:40:21", "dropoff_datetime": "2016-05-28 17:56:44", "passenger_count": "1", "pickup_longitude": "-73.969566345214844", "pickup_latitude": "40.7691650390625", "dropoff_longitude": "-73.986526489257813", "dropoff_latitude": "40.730335235595703", "store_and_fwd_flag": "N", "trip_duration": "983"}, {"id": "id3089912", "vendor_id": "2", "pickup_datetime": "2016-06-13 13:22:04", "dropoff_datetime": "2016-06-13 13:31:29", "passenger_count": "2", "pickup_longitude": "-73.989959716796875", "pickup_latitude": "40.741081237792969", "dropoff_longitude": "-73.976966857910156", "dropoff_latitude": "40.747451782226563", "store_and_fwd_flag": "N", "trip_duration": "565"}, {"id": "id1137965", "vendor_id": "1", "pickup_datetime": "2016-05-16 15:02:10", "dropoff_datetime": "2016-05-16 15:08:01", "passenger_count": "1", "pickup_longitude": "-73.9891357421875", "pickup_latitude": "40.775020599365234", "dropoff_longitude": "-73.981819152832031", "dropoff_latitude": "40.766059875488281", "store_and_fwd_flag": "N", "trip_duration": "351"}, {"id": "id3677225", "vendor_id": "2", "pickup_datetime": "2016-01-09 15:07:03", "dropoff_datetime": "2016-01-09 15:12:45", "passenger_count": "1", "pickup_longitude": "-73.967880249023438", "pickup_latitude": "40.759811401367188", "dropoff_longitude": "-73.953826904296875", "dropoff_latitude": "40.778881072998047", "store_and_fwd_flag": "N", "trip_duration": "342"}, {"id": "id0401226", "vendor_id": "1", "pickup_datetime": "2016-05-26 06:37:10", "dropoff_datetime": "2016-05-26 06:52:19", "passenger_count": "4", "pickup_longitude": "-74.006706237792969", "pickup_latitude": "40.705554962158203", "dropoff_longitude": "-73.991691589355469", "dropoff_latitude": "40.749721527099609", "store_and_fwd_flag": "N", "trip_duration": "909"}, {"id": "id2452605", "vendor_id": "2", "pickup_datetime": "2016-05-22 22:42:31", "dropoff_datetime": "2016-05-22 22:46:18", "passenger_count": "1", "pickup_longitude": "-73.996269226074219", "pickup_latitude": "40.749851226806641", "dropoff_longitude": "-73.994766235351563", "dropoff_latitude": "40.736480712890625", "store_and_fwd_flag": "N", "trip_duration": "227"}, {"id": "id3618302", "vendor_id": "2", "pickup_datetime": "2016-04-19 09:27:04", "dropoff_datetime": "2016-04-19 09:45:02", "passenger_count": "6", "pickup_longitude": "-73.987319946289062", "pickup_latitude": "40.750640869140625", "dropoff_longitude": "-73.989288330078125", "dropoff_latitude": "40.769405364990234", "store_and_fwd_flag": "N", "trip_duration": "1078"}, {"id": "id1552358", "vendor_id": "2", "pickup_datetime": "2016-04-01 07:55:30", "dropoff_datetime": "2016-04-01 08:10:30", "passenger_count": "1", "pickup_longitude": "-73.975433349609375", "pickup_latitude": "40.752132415771484", "dropoff_longitude": "-73.99078369140625", "dropoff_latitude": "40.750942230224609", "store_and_fwd_flag": "N", "trip_duration": "900"}, {"id": "id1168234", "vendor_id": "1", "pickup_datetime": "2016-02-01 18:02:59", "dropoff_datetime": "2016-02-01 18:13:30", "passenger_count": "1", "pickup_longitude": "-74.000205993652344", "pickup_latitude": "40.737846374511719", "dropoff_longitude": "-74.000312805175781", "dropoff_latitude": "40.722866058349609", "store_and_fwd_flag": "N", "trip_duration": "631"}, {"id": "id2910320", "vendor_id": "2", "pickup_datetime": "2016-04-20 07:33:12", "dropoff_datetime": "2016-04-20 07:56:17", "passenger_count": "1", "pickup_longitude": "-73.955459594726563", "pickup_latitude": "40.767307281494141", "dropoff_longitude": "-73.988998413085938", "dropoff_latitude": "40.693168640136719", "store_and_fwd_flag": "N", "trip_duration": "1385"}, {"id": "id3331830", "vendor_id": "1", "pickup_datetime": "2016-04-12 09:21:27", "dropoff_datetime": "2016-04-12 09:35:56", "passenger_count": "1", "pickup_longitude": "-73.964866638183594", "pickup_latitude": "40.755790710449219", "dropoff_longitude": "-73.975807189941406", "dropoff_latitude": "40.757354736328125", "store_and_fwd_flag": "N", "trip_duration": "869"}, {"id": "id0195963", "vendor_id": "2", "pickup_datetime": "2016-06-19 18:39:05", "dropoff_datetime": "2016-06-19 18:48:39", "passenger_count": "1", "pickup_longitude": "-73.999160766601563", "pickup_latitude": "40.744369506835938", "dropoff_longitude": "-73.98870849609375", "dropoff_latitude": "40.758701324462891", "store_and_fwd_flag": "N", "trip_duration": "574"}, {"id": "id0762989", "vendor_id": "2", "pickup_datetime": "2016-03-17 08:24:27", "dropoff_datetime": "2016-03-17 08:26:11", "passenger_count": "1", "pickup_longitude": "-73.977615356445313", "pickup_latitude": "40.763572692871094", "dropoff_longitude": "-73.972572326660156", "dropoff_latitude": "40.765956878662109", "store_and_fwd_flag": "N", "trip_duration": "104"}, {"id": "id2671060", "vendor_id": "2", "pickup_datetime": "2016-04-07 08:44:32", "dropoff_datetime": "2016-04-07 08:51:30", "passenger_count": "1", "pickup_longitude": "-73.953117370605469", "pickup_latitude": "40.771800994873047", "dropoff_longitude": "-73.947921752929687", "dropoff_latitude": "40.783149719238281", "store_and_fwd_flag": "N", "trip_duration": "418"}, {"id": "id3620795", "vendor_id": "1", "pickup_datetime": "2016-01-01 10:45:24", "dropoff_datetime": "2016-01-01 10:51:47", "passenger_count": "1", "pickup_longitude": "-74.001609802246094", "pickup_latitude": "40.740810394287109", "dropoff_longitude": "-73.996223449707031", "dropoff_latitude": "40.725902557373047", "store_and_fwd_flag": "N", "trip_duration": "383"}, {"id": "id2282206", "vendor_id": "1", "pickup_datetime": "2016-01-04 16:32:42", "dropoff_datetime": "2016-01-04 16:51:19", "passenger_count": "2", "pickup_longitude": "-73.962181091308594", "pickup_latitude": "40.810726165771484", "dropoff_longitude": "-73.994834899902344", "dropoff_latitude": "40.752811431884766", "store_and_fwd_flag": "N", "trip_duration": "1117"}, {"id": "id0591292", "vendor_id": "1", "pickup_datetime": "2016-06-09 18:43:04", "dropoff_datetime": "2016-06-09 19:07:11", "passenger_count": "1", "pickup_longitude": "-73.986968994140625", "pickup_latitude": "40.742851257324219", "dropoff_longitude": "-73.994285583496094", "dropoff_latitude": "40.761356353759766", "store_and_fwd_flag": "N", "trip_duration": "1447"}, {"id": "id0906779", "vendor_id": "1", "pickup_datetime": "2016-04-19 08:31:48", "dropoff_datetime": "2016-04-19 09:14:11", "passenger_count": "2", "pickup_longitude": "-73.9715576171875", "pickup_latitude": "40.750629425048828", "dropoff_longitude": "-73.952629089355469", "dropoff_latitude": "40.631595611572266", "store_and_fwd_flag": "N", "trip_duration": "2543"}, {"id": "id2326430", "vendor_id": "2", "pickup_datetime": "2016-06-10 22:06:53", "dropoff_datetime": "2016-06-10 22:23:14", "passenger_count": "1", "pickup_longitude": "-73.956878662109375", "pickup_latitude": "40.774871826171875", "dropoff_longitude": "-73.936508178710938", "dropoff_latitude": "40.857185363769531", "store_and_fwd_flag": "N", "trip_duration": "981"}, {"id": "id3863815", "vendor_id": "2", "pickup_datetime": "2016-03-14 04:24:36", "dropoff_datetime": "2016-03-14 04:37:11", "passenger_count": "3", "pickup_longitude": "-73.944358825683594", "pickup_latitude": "40.714488983154297", "dropoff_longitude": "-73.910530090332031", "dropoff_latitude": "40.709491729736328", "store_and_fwd_flag": "N", "trip_duration": "755"}, {"id": "id3048297", "vendor_id": "2", "pickup_datetime": "2016-04-06 08:53:11", "dropoff_datetime": "2016-04-06 09:14:08", "passenger_count": "1", "pickup_longitude": "-73.972793579101563", "pickup_latitude": "40.755596160888672", "dropoff_longitude": "-73.873123168945313", "dropoff_latitude": "40.774456024169922", "store_and_fwd_flag": "N", "trip_duration": "1257"}, {"id": "id3649509", "vendor_id": "1", "pickup_datetime": "2016-04-02 14:46:23", "dropoff_datetime": "2016-04-02 15:06:44", "passenger_count": "2", "pickup_longitude": "-74.005546569824219", "pickup_latitude": "40.709262847900391", "dropoff_longitude": "-73.970146179199219", "dropoff_latitude": "40.762741088867188", "store_and_fwd_flag": "N", "trip_duration": "1221"}, {"id": "id1783063", "vendor_id": "2", "pickup_datetime": "2016-04-06 12:24:22", "dropoff_datetime": "2016-04-06 12:40:02", "passenger_count": "2", "pickup_longitude": "-73.984649658203125", "pickup_latitude": "40.745979309082031", "dropoff_longitude": "-73.977378845214844", "dropoff_latitude": "40.759651184082031", "store_and_fwd_flag": "N", "trip_duration": "940"}, {"id": "id3363012", "vendor_id": "2", "pickup_datetime": "2016-04-12 20:22:49", "dropoff_datetime": "2016-04-12 20:24:55", "passenger_count": "1", "pickup_longitude": "-73.961967468261719", "pickup_latitude": "40.77008056640625", "dropoff_longitude": "-73.960777282714844", "dropoff_latitude": "40.775051116943359", "store_and_fwd_flag": "N", "trip_duration": "126"}, {"id": "id0514638", "vendor_id": "1", "pickup_datetime": "2016-02-10 08:36:33", "dropoff_datetime": "2016-02-10 08:42:23", "passenger_count": "1", "pickup_longitude": "-73.96942138671875", "pickup_latitude": "40.800033569335938", "dropoff_longitude": "-73.968177795410156", "dropoff_latitude": "40.791702270507813", "store_and_fwd_flag": "N", "trip_duration": "350"}, {"id": "id0627115", "vendor_id": "2", "pickup_datetime": "2016-02-26 16:10:47", "dropoff_datetime": "2016-02-26 16:23:04", "passenger_count": "1", "pickup_longitude": "-73.982627868652344", "pickup_latitude": "40.762111663818359", "dropoff_longitude": "-73.993370056152344", "dropoff_latitude": "40.747489929199219", "store_and_fwd_flag": "N", "trip_duration": "737"}, {"id": "id3141299", "vendor_id": "2", "pickup_datetime": "2016-01-14 12:25:54", "dropoff_datetime": "2016-01-14 12:37:24", "passenger_count": "3", "pickup_longitude": "-73.995773315429688", "pickup_latitude": "40.742568969726563", "dropoff_longitude": "-74.008094787597656", "dropoff_latitude": "40.722770690917969", "store_and_fwd_flag": "N", "trip_duration": "690"}, {"id": "id2003497", "vendor_id": "1", "pickup_datetime": "2016-04-15 11:58:45", "dropoff_datetime": "2016-04-15 12:09:56", "passenger_count": "2", "pickup_longitude": "-74.000076293945312", "pickup_latitude": "40.748298645019531", "dropoff_longitude": "-73.989883422851562", "dropoff_latitude": "40.737964630126953", "store_and_fwd_flag": "N", "trip_duration": "671"}, {"id": "id3748197", "vendor_id": "1", "pickup_datetime": "2016-02-07 23:17:58", "dropoff_datetime": "2016-02-07 23:25:41", "passenger_count": "1", "pickup_longitude": "-73.999168395996094", "pickup_latitude": "40.734233856201172", "dropoff_longitude": "-73.982093811035156", "dropoff_latitude": "40.740276336669922", "store_and_fwd_flag": "N", "trip_duration": "463"}, {"id": "id2983261", "vendor_id": "1", "pickup_datetime": "2016-04-15 14:41:14", "dropoff_datetime": "2016-04-15 14:47:21", "passenger_count": "1", "pickup_longitude": "-74.014251708984375", "pickup_latitude": "40.713912963867188", "dropoff_longitude": "-74.004623413085938", "dropoff_latitude": "40.70538330078125", "store_and_fwd_flag": "N", "trip_duration": "367"}, {"id": "id0485870", "vendor_id": "2", "pickup_datetime": "2016-06-19 20:23:09", "dropoff_datetime": "2016-06-19 20:29:18", "passenger_count": "1", "pickup_longitude": "-73.990898132324219", "pickup_latitude": "40.750663757324219", "dropoff_longitude": "-73.993217468261719", "dropoff_latitude": "40.734199523925781", "store_and_fwd_flag": "N", "trip_duration": "369"}, {"id": "id0835694", "vendor_id": "1", "pickup_datetime": "2016-01-15 19:25:12", "dropoff_datetime": "2016-01-15 19:31:54", "passenger_count": "1", "pickup_longitude": "-73.975105285644531", "pickup_latitude": "40.755691528320313", "dropoff_longitude": "-73.985595703125", "dropoff_latitude": "40.747474670410156", "store_and_fwd_flag": "N", "trip_duration": "402"}, {"id": "id3426410", "vendor_id": "2", "pickup_datetime": "2016-02-18 09:27:07", "dropoff_datetime": "2016-02-18 09:45:20", "passenger_count": "5", "pickup_longitude": "-73.967437744140625", "pickup_latitude": "40.759349822998047", "dropoff_longitude": "-74.012687683105469", "dropoff_latitude": "40.701610565185547", "store_and_fwd_flag": "N", "trip_duration": "1093"}, {"id": "id3673678", "vendor_id": "2", "pickup_datetime": "2016-01-31 13:52:55", "dropoff_datetime": "2016-01-31 14:03:52", "passenger_count": "1", "pickup_longitude": "-73.975997924804688", "pickup_latitude": "40.751136779785156", "dropoff_longitude": "-74.001853942871094", "dropoff_latitude": "40.7352294921875", "store_and_fwd_flag": "N", "trip_duration": "657"}, {"id": "id2460349", "vendor_id": "1", "pickup_datetime": "2016-01-07 15:40:34", "dropoff_datetime": "2016-01-07 15:49:24", "passenger_count": "2", "pickup_longitude": "-73.978950500488281", "pickup_latitude": "40.750930786132813", "dropoff_longitude": "-73.964393615722656", "dropoff_latitude": "40.754962921142578", "store_and_fwd_flag": "N", "trip_duration": "530"}, {"id": "id3198639", "vendor_id": "1", "pickup_datetime": "2016-06-05 03:02:46", "dropoff_datetime": "2016-06-05 03:14:59", "passenger_count": "1", "pickup_longitude": "-73.979789733886719", "pickup_latitude": "40.781265258789063", "dropoff_longitude": "-73.940879821777344", "dropoff_latitude": "40.823223114013672", "store_and_fwd_flag": "N", "trip_duration": "733"}, {"id": "id1872601", "vendor_id": "2", "pickup_datetime": "2016-05-31 19:16:05", "dropoff_datetime": "2016-05-31 19:27:44", "passenger_count": "2", "pickup_longitude": "-73.986862182617188", "pickup_latitude": "40.750961303710938", "dropoff_longitude": "-74.005378723144531", "dropoff_latitude": "40.740028381347656", "store_and_fwd_flag": "N", "trip_duration": "699"}, {"id": "id0125957", "vendor_id": "1", "pickup_datetime": "2016-06-14 21:16:43", "dropoff_datetime": "2016-06-14 21:21:37", "passenger_count": "2", "pickup_longitude": "-73.967018127441406", "pickup_latitude": "40.753005981445313", "dropoff_longitude": "-73.951629638671875", "dropoff_latitude": "40.769359588623047", "store_and_fwd_flag": "N", "trip_duration": "294"}, {"id": "id3526986", "vendor_id": "2", "pickup_datetime": "2016-02-23 13:28:59", "dropoff_datetime": "2016-02-23 13:40:00", "passenger_count": "1", "pickup_longitude": "-73.970382690429688", "pickup_latitude": "40.764991760253906", "dropoff_longitude": "-73.949668884277344", "dropoff_latitude": "40.768459320068359", "store_and_fwd_flag": "N", "trip_duration": "661"}, {"id": "id3170873", "vendor_id": "1", "pickup_datetime": "2016-06-30 21:35:27", "dropoff_datetime": "2016-06-30 21:46:19", "passenger_count": "1", "pickup_longitude": "-74.002433776855469", "pickup_latitude": "40.717166900634766", "dropoff_longitude": "-73.985969543457031", "dropoff_latitude": "40.726749420166016", "store_and_fwd_flag": "N", "trip_duration": "652"}, {"id": "id1674373", "vendor_id": "2", "pickup_datetime": "2016-02-15 17:52:27", "dropoff_datetime": "2016-02-15 18:02:13", "passenger_count": "5", "pickup_longitude": "-74.007499694824219", "pickup_latitude": "40.740951538085938", "dropoff_longitude": "-74.016647338867188", "dropoff_latitude": "40.704910278320313", "store_and_fwd_flag": "N", "trip_duration": "586"}, {"id": "id2973697", "vendor_id": "2", "pickup_datetime": "2016-04-07 22:52:23", "dropoff_datetime": "2016-04-07 23:10:00", "passenger_count": "2", "pickup_longitude": "-73.995384216308594", "pickup_latitude": "40.749298095703125", "dropoff_longitude": "-73.989326477050781", "dropoff_latitude": "40.718147277832031", "store_and_fwd_flag": "N", "trip_duration": "1057"}, {"id": "id1592044", "vendor_id": "1", "pickup_datetime": "2016-01-29 11:23:23", "dropoff_datetime": "2016-01-29 11:33:03", "passenger_count": "1", "pickup_longitude": "-73.986679077148438", "pickup_latitude": "40.725849151611328", "dropoff_longitude": "-73.997467041015625", "dropoff_latitude": "40.735153198242187", "store_and_fwd_flag": "N", "trip_duration": "580"}, {"id": "id3899813", "vendor_id": "2", "pickup_datetime": "2016-06-01 20:15:24", "dropoff_datetime": "2016-06-01 20:34:35", "passenger_count": "5", "pickup_longitude": "-73.980026245117188", "pickup_latitude": "40.765968322753906", "dropoff_longitude": "-73.991203308105469", "dropoff_latitude": "40.750350952148438", "store_and_fwd_flag": "N", "trip_duration": "1151"}, {"id": "id2075052", "vendor_id": "1", "pickup_datetime": "2016-04-09 09:09:03", "dropoff_datetime": "2016-04-09 09:20:03", "passenger_count": "1", "pickup_longitude": "-73.954498291015625", "pickup_latitude": "40.766807556152344", "dropoff_longitude": "-73.987785339355469", "dropoff_latitude": "40.720878601074219", "store_and_fwd_flag": "N", "trip_duration": "660"}, {"id": "id3707411", "vendor_id": "1", "pickup_datetime": "2016-01-03 02:03:39", "dropoff_datetime": "2016-01-03 02:17:02", "passenger_count": "1", "pickup_longitude": "-74.007728576660156", "pickup_latitude": "40.740608215332031", "dropoff_longitude": "-73.983512878417969", "dropoff_latitude": "40.737209320068359", "store_and_fwd_flag": "N", "trip_duration": "803"}, {"id": "id1608545", "vendor_id": "1", "pickup_datetime": "2016-04-14 08:31:03", "dropoff_datetime": "2016-04-14 09:03:37", "passenger_count": "1", "pickup_longitude": "-74.006797790527344", "pickup_latitude": "40.731071472167969", "dropoff_longitude": "-73.974960327148438", "dropoff_latitude": "40.758468627929687", "store_and_fwd_flag": "N", "trip_duration": "1954"}, {"id": "id3517425", "vendor_id": "2", "pickup_datetime": "2016-01-16 20:34:06", "dropoff_datetime": "2016-01-16 20:51:16", "passenger_count": "6", "pickup_longitude": "-73.980926513671875", "pickup_latitude": "40.755241394042969", "dropoff_longitude": "-74.004554748535156", "dropoff_latitude": "40.729652404785156", "store_and_fwd_flag": "N", "trip_duration": "1030"}, {"id": "id3942917", "vendor_id": "1", "pickup_datetime": "2016-04-29 14:18:39", "dropoff_datetime": "2016-04-29 15:05:36", "passenger_count": "4", "pickup_longitude": "-73.862777709960937", "pickup_latitude": "40.769313812255859", "dropoff_longitude": "-73.986129760742188", "dropoff_latitude": "40.748580932617188", "store_and_fwd_flag": "N", "trip_duration": "2817"}, {"id": "id2000923", "vendor_id": "2", "pickup_datetime": "2016-03-29 06:07:38", "dropoff_datetime": "2016-03-29 06:09:03", "passenger_count": "5", "pickup_longitude": "-73.987869262695312", "pickup_latitude": "40.765098571777344", "dropoff_longitude": "-73.993606567382812", "dropoff_latitude": "40.758949279785156", "store_and_fwd_flag": "N", "trip_duration": "85"}]'
        worker.handler({"Records": [{"body": data, "messageId": 1234, "receiptHandle": "hadnlereceipt"}]}, {})

    def test_get_distance(self):
        latitude = (40.77716064453125, 40.774547576904297)
        longitude = (-73.97821044921875, -73.957626342773438)

        print(worker.get_distance(latitude, longitude))
